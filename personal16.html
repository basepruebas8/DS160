<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Personal 16</title>
  <style>
    :root{
      color-scheme: light dark;
      --bg:#f6f7fb; --card:#fff; --text:#0f172a; --muted:#475569; --border:#e2e8f0;
      --accent:#2563eb; --accent-600:#1d4ed8; --accent-700:#1e40af; --ring:#93c5fd;
      --shadow:0 10px 30px rgba(2,8,23,.08);
    }
    @media (prefers-color-scheme: dark){
      :root{ --bg:#0b1220; --card:#0f172a; --text:#e5e7eb; --muted:#94a3b8; --border:#233044;
             --accent:#60a5fa; --accent-600:#3b82f6; --accent-700:#2563eb; --ring:#60a5fa;
             --shadow:0 12px 36px rgba(0,0,0,.35);}
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial,"Noto Sans","Helvetica Neue",sans-serif;color:var(--text)}
    .wrap{max-width:960px;margin:32px auto;padding:0 16px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:18px;box-shadow:var(--shadow);padding:24px}
    header h1{margin:0 0 6px;font-size:1.35rem}
    .subtle{color:var(--muted);margin-bottom:18px}
    fieldset{border:1px solid var(--border);border-radius:14px;padding:18px;margin:16px 0;background:linear-gradient(180deg,rgba(148,163,184,.06),transparent 60%)}
    legend{font-weight:700;padding:0 10px;font-size:.98rem}
    label{display:inline-block;margin:8px 0 6px;font-weight:600}
    .row{display:grid;grid-template-columns:1fr;gap:10px}
    .inline{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .help{font-size:.9rem;color:var(--muted)}
    [hidden]{display:none!important}
    textarea,input[type="text"]{width:100%;max-width:640px;padding:10px 12px;border:1px solid var(--border);border-radius:12px;background:var(--card);color:var(--text);outline:none;transition:border-color .15s, box-shadow .15s, transform .06s;box-shadow:inset 0 1px 0 rgba(255,255,255,.05);text-transform:uppercase}
    textarea:focus,input[type="text"]:focus{border-color:var(--accent);box-shadow:0 0 0 3px color-mix(in oklab, var(--ring) 45%, transparent)}
    .actions{margin-top:18px;display:flex;gap:12px;align-items:center;border-top:1px dashed var(--border);padding-top:16px}
    button{padding:10px 16px;border-radius:12px;border:1px solid var(--border);background:var(--card);cursor:pointer;font-weight:600;transition:transform .06s, box-shadow .15s, background .2s, border-color .15s}
    button.primary{background:linear-gradient(180deg,var(--accent),var(--accent-600));color:#fff;border-color:transparent;box-shadow:0 6px 16px rgba(37,99,235,.35)}
    button.primary:hover{background:linear-gradient(180deg,var(--accent-600),var(--accent-700));transform:translateY(-.5px)}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <h1>Solicitud de Visa de No Inmigrante (DS-160)</h1>
        <div class="subtle">Secci√≥n: <strong>Seguridad y antecedentes ‚Äî Parte 5</strong></div>
      </header>

      <form id="ds160-secback5" action="#" method="post" novalidate>
        <!-- üîí TODOS los campos ocultos del original (placeholders donde aplica) -->
        <input type="hidden" id="Hidden1" name="Hidden1" value="" />

        <input type="hidden" id="__EVENTTARGET" name="__EVENTTARGET" value="" />
        <input type="hidden" id="__EVENTARGUMENT" name="__EVENTARGUMENT" value="" />
        <input type="hidden" id="__LASTFOCUS" name="__LASTFOCUS" value="" />

        <!-- Si lo deseas, pega aqu√≠ el valor REAL del __VIEWSTATE (muy largo en el original) -->
        <input type="hidden" id="__VIEWSTATE" name="__VIEWSTATE" value="" />

        <!-- Estos vienen del HTML que compartiste -->
        <input type="hidden" id="__VIEWSTATEGENERATOR" name="__VIEWSTATEGENERATOR" value="AF621FA0" />
        <input type="hidden" id="__SCROLLPOSITIONX" name="__SCROLLPOSITIONX" value="0" />
        <input type="hidden" id="__SCROLLPOSITIONY" name="__SCROLLPOSITIONY" value="0" />
        <input type="hidden" id="__VIEWSTATEENCRYPTED" name="__VIEWSTATEENCRYPTED" value="" />
        <input type="hidden" id="__PREVIOUSPAGE" name="__PREVIOUSPAGE" value="Z5BZUi5qseHNgj9-BTM7_r12UzSuvn6M9PegN2I5N8jp48pFwmB5ZNwMug5j3DvMFuwvKzJ9QWMRf9LnPCD15dRSBpHuTPrFBFtyhYHxfKyUYCzxh9l8fnbYbwGpMhupVAlsYA2" />

        <input type="hidden" id="ctl00_HDClearSession" name="ctl00$HDClearSession" value="" />
        <input type="hidden" id="ctl00_SiteContentPlaceHolder_HiddenPageValid" name="ctl00$SiteContentPlaceHolder$HiddenPageValid" value="" />
        <input type="hidden" id="ctl00_HiddenSideBarItemClicked" name="ctl00$HiddenSideBarItemClicked" value="" />

        <!-- Campos de contexto √∫tiles para tu maqueta -->
        <input type="hidden" id="APPLICATION_ID" name="APPLICATION_ID" value="AA00F3A013" />
        <input type="hidden" id="NODE" name="NODE" value="SecurityandBackground5" />

        <fieldset>
          <legend>Seguridad y antecedentes: Parte 5</legend>
          <p class="help">Nota: Proporcione informaci√≥n completa y exacta. Si marca ‚ÄúS√≠‚Äù, explique con detalles.</p>

          <!-- Q1) Custodia de menor ciudadano de EE. UU. -->
          <div class="row">
            <label>¬øAlguna vez ha retenido fuera de Estados Unidos la custodia de un(a) menor ciudadano(a) de EE. UU. a una persona con custodia legal otorgada por un tribunal estadounidense?</label>
            <div class="inline" role="radiogroup" aria-label="Retenci√≥n de custodia">
              <label style="font-weight:400;"><input type="radio" name="CUSTODY_IND" value="Y" id="CUSTODY_Y"> S√≠</label>
              <label style="font-weight:400;"><input type="radio" name="CUSTODY_IND" value="N" id="CUSTODY_N" checked> No</label>
            </div>
          </div>
          <div id="CUSTODY_EXPL_WRAP" class="row" hidden>
            <label for="CUSTODY_EXPL">Explique</label>
            <textarea id="CUSTODY_EXPL" name="CUSTODY_EXPL" rows="4" maxlength="4000" placeholder="DETALLES / FECHAS / TRIBUNAL / PA√çSES INVOLUCRADOS"></textarea>
          </div>

          <!-- Q2) Votaci√≥n en EE. UU. en violaci√≥n de la ley -->
          <div class="row" style="margin-top:8px;">
            <label>¬øHa votado en Estados Unidos en violaci√≥n de alguna ley o reglamento?</label>
            <div class="inline" role="radiogroup" aria-label="Violaci√≥n por votar">
              <label style="font-weight:400;"><input type="radio" name="VOTE_VIOLATE_IND" value="Y" id="VOTE_Y"> S√≠</label>
              <label style="font-weight:400;"><input type="radio" name="VOTE_VIOLATE_IND" value="N" id="VOTE_N" checked> No</label>
            </div>
          </div>
          <div id="VOTE_EXPL_WRAP" class="row" hidden>
            <label for="VOTE_EXPL">Explique</label>
            <textarea id="VOTE_EXPL" name="VOTE_EXPL" rows="4" maxlength="4000" placeholder="CU√ÅNDO / D√ìNDE / C√ìMO SE PRODUJO / DETALLES"></textarea>
          </div>

          <!-- Q3) Renuncia a ciudadan√≠a de EE. UU. para evitar impuestos -->
          <div class="row" style="margin-top:8px;">
            <label>¬øAlguna vez ha renunciado a la ciudadan√≠a de Estados Unidos con el fin de evitar la imposici√≥n de impuestos?</label>
            <div class="inline" role="radiogroup" aria-label="Renuncia por impuestos">
              <label style="font-weight:400;"><input type="radio" name="RENOUNCE_IND" value="Y" id="RENOUNCE_Y"> S√≠</label>
              <label style="font-weight:400;"><input type="radio" name="RENOUNCE_IND" value="N" id="RENOUNCE_N" checked> No</label>
            </div>
          </div>
          <div id="RENOUNCE_EXPL_WRAP" class="row" hidden>
            <label for="RENOUNCE_EXPL">Explique</label>
            <textarea id="RENOUNCE_EXPL" name="RENOUNCE_EXPL" rows="4" maxlength="4000" placeholder="FECHAS / LUGAR / MOTIVOS / DOCUMENTACI√ìN"></textarea>
          </div>

          <!-- Placeholder por si luego agregas m√°s bloques (upnlReimburse estaba vac√≠o) -->
          <div id="REIMBURSE_WRAP" class="row" hidden></div>
        </fieldset>

        <div class="actions">
          <button type="button" id="backBtn">Regresar</button>
          <button type="button" id="nextBtn" class="primary">Ver Respuestas</button>
        </div>

        <noscript>
          <p class="help">La navegaci√≥n requiere JavaScript. Enlaces alternativos: <a href="DS160_15.html">Regresar</a> | <a href="borrador.html">Ver Respuestas</a></p>
        </noscript>
      </form>
    </div>
  </div>

  <script>
    // üß≠ Navegaci√≥n (como pediste)
    const BACK_URL = new URL('personal15.html', window.location.href).href;
    const NEXT_URL = new URL('finalizar.html', window.location.href).href;

    // üíæ Autosave
    const STORAGE_PREFIX = 'ds160:';
    const FORM_ID = 'ds160-secback5';
    function storageKey(field){
      const idOrName = field.type === 'radio' ? field.name : (field.id || field.name);
      return STORAGE_PREFIX + FORM_ID + ':' + idOrName;
    }
    function saveField(field){
      try{
        if (field.type === 'radio'){ if (field.checked) localStorage.setItem(storageKey(field), field.value); }
        else if (field.type === 'checkbox'){ localStorage.setItem(storageKey(field), field.checked ? '1':'0'); }
        else{ localStorage.setItem(storageKey(field), field.value); }
      }catch(e){}
    }
    function restoreField(field){
      try{
        const v = localStorage.getItem(storageKey(field));
        if (v==null) return;
        if (field.type === 'radio'){ field.checked = (field.value === v); }
        else if (field.type === 'checkbox'){ field.checked = (v === '1'); }
        else{ field.value = v; }
      }catch(e){}
    }
    function autosave(form){
      form.addEventListener('input', e => { const t=e.target; if (t && t.matches('input,select,textarea')) saveField(t); }, true);
      form.addEventListener('change', e => { const t=e.target; if (t && t.matches('input,select,textarea')) saveField(t); }, true);
    }

    const form = document.getElementById(FORM_ID);

    // Refs
    const CUSTODY_Y = document.getElementById('CUSTODY_Y');
    const CUSTODY_N = document.getElementById('CUSTODY_N');
    const CUSTODY_WRAP = document.getElementById('CUSTODY_EXPL_WRAP');
    const CUSTODY_EXPL = document.getElementById('CUSTODY_EXPL');

    const VOTE_Y = document.getElementById('VOTE_Y');
    const VOTE_N = document.getElementById('VOTE_N');
    const VOTE_WRAP = document.getElementById('VOTE_EXPL_WRAP');
    const VOTE_EXPL = document.getElementById('VOTE_EXPL');

    const RENOUNCE_Y = document.getElementById('RENOUNCE_Y');
    const RENOUNCE_N = document.getElementById('RENOUNCE_N');
    const RENOUNCE_WRAP = document.getElementById('RENOUNCE_EXPL_WRAP');
    const RENOUNCE_EXPL = document.getElementById('RENOUNCE_EXPL');

    // ‚úçüèº Forzar MAY√öSCULAS en textos libres
    function upperize(el){
      const s = el.selectionStart, e = el.selectionEnd;
      el.value = (el.value || '').toUpperCase();
      try { el.setSelectionRange(s,e); } catch(_){}
    }
    ;[CUSTODY_EXPL, VOTE_EXPL, RENOUNCE_EXPL].forEach(el=>{
      el.addEventListener('input', ()=>upperize(el));
      if (el && el.value) upperize(el);
    });

    // Mostrar/ocultar ‚ÄúExplique‚Äù + required
    function toggleExplain(rYes, wrap, textarea){
      const show = rYes.checked;
      wrap.hidden = !show;
      textarea.required = show;
      if (!show) textarea.setCustomValidity('');
    }
    function attachGroup(rYes, rNo, wrap, txt){
      const update = ()=>toggleExplain(rYes, wrap, txt);
      rYes.addEventListener('change', update);
      rNo.addEventListener('change', update);
      update();
    }

    // Restaurar valores guardados
    (function restoreForm(){
      const fields = form.querySelectorAll('input,select,textarea');
      fields.forEach(f => restoreField(f));
    })();

    // Defaults a ‚ÄúNo‚Äù si no hay dato previo
    const defaults = [
      ['CUSTODY_IND', CUSTODY_N],
      ['VOTE_VIOLATE_IND', VOTE_N],
      ['RENOUNCE_IND', RENOUNCE_N],
    ];
    defaults.forEach(([name, rNo])=>{
      if (!localStorage.getItem(STORAGE_PREFIX + FORM_ID + ':' + name)) rNo.checked = true;
    });

    // Enlazar l√≥gicas
    attachGroup(CUSTODY_Y, CUSTODY_N, CUSTODY_WRAP, CUSTODY_EXPL);
    attachGroup(VOTE_Y, VOTE_N, VOTE_WRAP, VOTE_EXPL);
    attachGroup(RENOUNCE_Y, RENOUNCE_N, RENOUNCE_WRAP, RENOUNCE_EXPL);

    // Activar autosave
    autosave(form);

    // Navegaci√≥n
    document.getElementById('backBtn').addEventListener('click', ()=>{
      form.querySelectorAll('input,select,textarea').forEach(saveField);
      window.location.assign(BACK_URL);
    });
    document.getElementById('nextBtn').addEventListener('click', ()=>{
      if (!form.checkValidity()){
        form.reportValidity();
        const firstInvalid = form.querySelector(':invalid');
        if (firstInvalid) firstInvalid.scrollIntoView({behavior:'smooth', block:'center'});
        return;
      }
      form.querySelectorAll('input,select,textarea').forEach(saveField);
      window.location.assign(NEXT_URL);
    });
  </script>
</body>
</html>
